{"title":"SQL","markdown":{"yaml":{"description":"SQL (Structured Query Language) is the standard language for managing and manipulating relational databases. It allows you to query, insert, update, delete, and manage data, making it a cornerstone of database management. Here’s a comprehensive guide to understanding SQL, with examples and key concepts.","output-file":"sql.html","skip_exec":true,"skip_showdoc":true,"title":"SQL"},"headingText":"1. **What is SQL?**","containsRefs":false,"markdown":"\n\n\n\n<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->\n\n   - **Language for Databases**: SQL is used to communicate with relational database management systems (RDBMS) such as MySQL, PostgreSQL, SQLite, Oracle, and Microsoft SQL Server.\n   - **Declarative Language**: SQL focuses on *what* data to retrieve or modify rather than *how* to do it, which the database engine handles.\n\n### 2. **Key SQL Commands**\nSQL commands are divided into categories based on their purpose:\n\n#### Data Definition Language (DDL)\n   - **`CREATE`**: Creates new tables, databases, indexes, and other objects.\n   - **`ALTER`**: Modifies an existing database object, such as a table.\n   - **`DROP`**: Deletes objects from the database.\n   - **`TRUNCATE`**: Removes all records from a table (without deleting the table itself).\n\n#### Data Manipulation Language (DML)\n   - **`SELECT`**: Retrieves data from the database.\n   - **`INSERT`**: Adds new records to a table.\n   - **`UPDATE`**: Modifies existing records in a table.\n   - **`DELETE`**: Removes records from a table.\n\n#### Data Control Language (DCL)\n   - **`GRANT`**: Grants permissions to users.\n   - **`REVOKE`**: Revokes permissions from users.\n\n#### Transaction Control Language (TCL)\n   - **`COMMIT`**: Saves changes to the database.\n   - **`ROLLBACK`**: Undoes changes since the last commit.\n   - **`SAVEPOINT`**: Sets a savepoint within a transaction to which you can later roll back.\n\n### 3. **Creating and Modifying Tables (DDL)**\n\n#### Create a Table\n```sql\nCREATE TABLE employees (\n    id INT PRIMARY KEY,\n    name VARCHAR(50),\n    position VARCHAR(50),\n    salary DECIMAL(10, 2),\n    hire_date DATE\n);\n```\n\n#### Alter a Table\nAdd a new column:\n```sql\nALTER TABLE employees\nADD email VARCHAR(100);\n```\n\nRemove a column:\n```sql\nALTER TABLE employees\nDROP COLUMN email;\n```\n\n#### Drop a Table\n```sql\nDROP TABLE employees;\n```\n\n### 4. **Basic Data Operations (DML)**\n\n#### Inserting Data\n```sql\nINSERT INTO employees (id, name, position, salary, hire_date)\nVALUES (1, 'John Doe', 'Software Engineer', 75000, '2022-01-15');\n```\n\n#### Selecting Data\n```sql\nSELECT name, position, salary\nFROM employees\nWHERE salary > 50000\nORDER BY hire_date DESC;\n```\n\n#### Updating Data\n```sql\nUPDATE employees\nSET salary = salary * 1.1  -- Increase salary by 10%\nWHERE position = 'Software Engineer';\n```\n\n#### Deleting Data\n```sql\nDELETE FROM employees\nWHERE hire_date < '2020-01-01';\n```\n\n### 5. **Querying Data with `SELECT`**\n\n#### Filtering with `WHERE`\n```sql\nSELECT * FROM employees\nWHERE position = 'Manager' AND salary > 70000;\n```\n\n#### Sorting with `ORDER BY`\n```sql\nSELECT name, salary FROM employees\nORDER BY salary DESC, name ASC;\n```\n\n#### Limiting Results with `LIMIT` (MySQL) / `FETCH FIRST` (SQL Server)\n```sql\nSELECT * FROM employees\nORDER BY salary DESC\nLIMIT 5;\n```\n\n#### Aggregating Data with Functions\n   - **`COUNT`**: Counts rows.\n   - **`SUM`**: Sums values.\n   - **`AVG`**: Calculates average.\n   - **`MIN`** and **`MAX`**: Find minimum and maximum values.\n\nExample:\n```sql\nSELECT AVG(salary) AS avg_salary, MAX(salary) AS max_salary\nFROM employees;\n```\n\n#### Grouping Results with `GROUP BY` and `HAVING`\n```sql\nSELECT position, AVG(salary) AS avg_salary\nFROM employees\nGROUP BY position\nHAVING avg_salary > 50000;\n```\n\n### 6. **Joins**\nJoins are used to retrieve data from multiple tables based on related columns.\n\n- **INNER JOIN**: Returns rows where there is a match in both tables.\n- **LEFT JOIN**: Returns all rows from the left table and matching rows from the right table.\n- **RIGHT JOIN**: Returns all rows from the right table and matching rows from the left.\n- **FULL OUTER JOIN**: Returns all rows from both tables, with NULLs where no match exists.\n\nExample of INNER JOIN:\n```sql\nSELECT employees.name, departments.department_name\nFROM employees\nINNER JOIN departments ON employees.department_id = departments.id;\n```\n\n### 7. **Subqueries**\nA subquery is a query nested within another query.\n\n#### Example: Subquery in `SELECT`\n```sql\nSELECT name,\n       (SELECT AVG(salary) FROM employees) AS avg_salary\nFROM employees\nWHERE salary > (SELECT AVG(salary) FROM employees);\n```\n\n### 8. **Indexes**\nIndexes improve the speed of data retrieval but may slow down insertions, updates, and deletions.\n\n```sql\nCREATE INDEX idx_position ON employees (position);\n```\n\n### 9. **Constraints**\nConstraints enforce data rules on tables, such as:\n   - **PRIMARY KEY**: Uniquely identifies each record.\n   - **FOREIGN KEY**: Ensures referential integrity between tables.\n   - **UNIQUE**: Ensures all values in a column are unique.\n   - **CHECK**: Ensures values meet a specific condition.\n   - **NOT NULL**: Ensures a column cannot contain NULL values.\n\nExample:\n```sql\nCREATE TABLE orders (\n    order_id INT PRIMARY KEY,\n    customer_id INT,\n    amount DECIMAL(10, 2) CHECK (amount > 0),\n    FOREIGN KEY (customer_id) REFERENCES customers(id)\n);\n```\n\n### 10. **Transactions and Atomicity**\nTransactions allow multiple SQL commands to be executed as a single unit.\n\n#### Example of Transaction with COMMIT and ROLLBACK\n```sql\nBEGIN;\n\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;\n\nCOMMIT;  -- Save changes\n-- Or ROLLBACK; to undo changes\n```\n\n### 11. **Views**\nViews are virtual tables that provide a way to save complex queries for easy reuse.\n\n```sql\nCREATE VIEW high_earners AS\nSELECT name, salary\nFROM employees\nWHERE salary > 80000;\n```\n\n### 12. **Stored Procedures and Functions**\nStored procedures and functions allow you to store reusable SQL code on the server side.\n\n#### Stored Procedure Example\n```sql\nCREATE PROCEDURE increase_salary (IN emp_id INT, IN increment DECIMAL(10, 2))\nBEGIN\n    UPDATE employees SET salary = salary + increment WHERE id = emp_id;\nEND;\n```\n\n#### User-Defined Function Example\n```sql\nCREATE FUNCTION get_full_name(first_name VARCHAR(50), last_name VARCHAR(50))\nRETURNS VARCHAR(100)\nBEGIN\n    RETURN CONCAT(first_name, ' ', last_name);\nEND;\n```\n\n### 13. **Common SQL Functions**\n   - **String Functions**: `UPPER`, `LOWER`, `CONCAT`, `SUBSTRING`.\n   - **Numeric Functions**: `ROUND`, `FLOOR`, `CEILING`, `ABS`.\n   - **Date Functions**: `NOW`, `CURDATE`, `YEAR`, `MONTH`, `DATEDIFF`.\n   - **Conversion Functions**: `CAST`, `CONVERT`.\n\n### 14. **Normalization**\nNormalization organizes data to reduce redundancy and dependency. Key normal forms include:\n   - **1NF (First Normal Form)**: Ensures each column contains atomic values.\n   - **2NF (Second Normal Form)**: Builds on 1NF by removing partial dependencies.\n   - **3NF (Third Normal Form)**: Removes transitive dependencies.\n\n### 15. **Advanced Concepts**\n   - **Recursive Queries**: Using `WITH RECURSIVE` for hierarchical data.\n   - **Window Functions**: Perform calculations across a set of table rows related to the current row (e.g., `ROW_NUMBER()`, `RANK()`).\n   - **Partitioning**: Divide large tables into smaller, manageable pieces.\n   - **Stored JSON Data**: Many RDBMS support storing and querying JSON data in tables.\n\n#### Example of a Recursive Query\n```sql\nWITH RECURSIVE org_chart AS (\n    SELECT employee_id, manager_id, name\n    FROM employees\n    WHERE manager_id IS NULL\n    UNION ALL\n    SELECT e.employee_id, e.manager_id, e.name\n    FROM employees e\n    JOIN org_chart oc ON e.manager_id = oc.employee_id\n)\nSELECT * FROM org_chart;\n```\n\n### 16. **Best Practices**\n   - Use indexes thoughtfully, as too many can slow down data modifications.\n   - Always back up your database before making major changes.\n   - Avoid using `SELECT *`; instead, specify columns for efficiency.\n   - Normalize tables to reduce redundancy and improve data integrity.\n\n\n## Django ORM to SQL\n\n> In Django, the **ORM (Object-Relational Mapping)** translates SQL operations into Python code, allowing you to interact with a database using Django's high-level `QuerySet` API. Here’s how common SQL concepts map to Django ORM concepts:\n\n### 1. **Models as Tables**\n\nIn Django, each database **table** is represented by a **model class**. Each field in the model corresponds to a column in the database table, and each instance of the model represents a row.\n\n#### SQL Table Definition\n```sql\nCREATE TABLE employee (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100),\n    department VARCHAR(50),\n    salary DECIMAL\n);\n```\n\n#### Django Model\n```python\nfrom django.db import models\n\nclass Employee(models.Model):\n    name = models.CharField(max_length=100)\n    department = models.CharField(max_length=50)\n    salary = models.DecimalField(max_digits=10, decimal_places=2)\n```\n\n### 2. **SQL Data Types to Django Field Types**\n\n| SQL Type      | Django Field Type              |\n|---------------|--------------------------------|\n| VARCHAR       | `models.CharField`             |\n| INTEGER       | `models.IntegerField`          |\n| DECIMAL       | `models.DecimalField`          |\n| DATE          | `models.DateField`             |\n| TIMESTAMP     | `models.DateTimeField`         |\n| BOOLEAN       | `models.BooleanField`          |\n| SERIAL        | `models.AutoField` (Primary Key by default) |\n\n### 3. **Basic CRUD Operations**\n\n#### CREATE: Inserting Data\nIn SQL:\n```sql\nINSERT INTO employee (name, department, salary) VALUES ('John Doe', 'Sales', 50000);\n```\n\nIn Django ORM:\n```python\nEmployee.objects.create(name=\"John Doe\", department=\"Sales\", salary=50000)\n```\n\n#### READ: Querying Data\n\n- **SELECT All**: Retrieve all rows from a table.\n\n    SQL:\n    ```sql\n    SELECT * FROM employee;\n    ```\n\n    Django ORM:\n    ```python\n    Employee.objects.all()\n    ```\n\n- **SELECT with WHERE Condition**:\n\n    SQL:\n    ```sql\n    SELECT * FROM employee WHERE department = 'Sales';\n    ```\n\n    Django ORM:\n    ```python\n    Employee.objects.filter(department=\"Sales\")\n    ```\n\n- **SELECT with Filtering and Ordering**:\n\n    SQL:\n    ```sql\n    SELECT * FROM employee WHERE department = 'Sales' ORDER BY salary DESC;\n    ```\n\n    Django ORM:\n    ```python\n    Employee.objects.filter(department=\"Sales\").order_by(\"-salary\")\n    ```\n\n#### UPDATE: Modifying Data\n\nIn SQL:\n```sql\nUPDATE employee SET salary = 55000 WHERE name = 'John Doe';\n```\n\nIn Django ORM:\n```python\nEmployee.objects.filter(name=\"John Doe\").update(salary=55000)\n```\n\n#### DELETE: Removing Data\n\nIn SQL:\n```sql\nDELETE FROM employee WHERE name = 'John Doe';\n```\n\nIn Django ORM:\n```python\nEmployee.objects.filter(name=\"John Doe\").delete()\n```\n\n### 4. **Relationships**\n\nDjango provides fields like `ForeignKey`, `OneToOneField`, and `ManyToManyField` to define relationships between models. These fields translate to `JOIN` operations in SQL.\n\n#### One-to-Many Relationship\n\nSQL:\n```sql\nCREATE TABLE department (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(50)\n);\n\nCREATE TABLE employee (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100),\n    department_id INTEGER REFERENCES department(id)\n);\n```\n\nDjango Models:\n```python\nclass Department(models.Model):\n    name = models.CharField(max_length=50)\n\nclass Employee(models.Model):\n    name = models.CharField(max_length=100)\n    department = models.ForeignKey(Department, on_delete=models.CASCADE)\n```\n\n**Querying with a Foreign Key**:\n```python\n# Get all employees in a specific department\nsales_dept = Department.objects.get(name=\"Sales\")\nemployees = Employee.objects.filter(department=sales_dept)\n```\n\n#### Many-to-Many Relationship\n\nSQL:\n```sql\nCREATE TABLE project (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100)\n);\n\nCREATE TABLE employee_project (\n    employee_id INTEGER REFERENCES employee(id),\n    project_id INTEGER REFERENCES project(id),\n    PRIMARY KEY (employee_id, project_id)\n);\n```\n\nDjango Models:\n```python\nclass Project(models.Model):\n    name = models.CharField(max_length=100)\n\nclass Employee(models.Model):\n    name = models.CharField(max_length=100)\n    projects = models.ManyToManyField(Project)\n```\n\n**Querying Many-to-Many Relationships**:\n```python\n# Get all projects for a specific employee\nemployee = Employee.objects.get(name=\"John Doe\")\nprojects = employee.projects.all()\n```\n\n### 5. **Aggregation and Grouping**\n\nThe Django ORM provides methods like `annotate()` and `aggregate()` for aggregation and grouping operations, similar to SQL’s `GROUP BY` and aggregate functions like `COUNT()`, `SUM()`, `AVG()`.\n\n#### Example: COUNT and GROUP BY\n\nSQL:\n```sql\nSELECT department, COUNT(*) FROM employee GROUP BY department;\n```\n\nDjango ORM:\n```python\nfrom django.db.models import Count\n\nEmployee.objects.values('department').annotate(count=Count('id'))\n```\n\n#### Example: SUM, AVG, MIN, MAX\n\nSQL:\n```sql\nSELECT AVG(salary) FROM employee WHERE department = 'Sales';\n```\n\nDjango ORM:\n```python\nfrom django.db.models import Avg\n\nEmployee.objects.filter(department=\"Sales\").aggregate(Avg('salary'))\n```\n\n### 6. **Joins with Django ORM**\n\nThe Django ORM automatically performs joins when you query across related models.\n\n#### Inner Join (default with ForeignKey)\n\nSQL:\n```sql\nSELECT employee.name, department.name\nFROM employee\nJOIN department ON employee.department_id = department.id;\n```\n\nDjango ORM:\n```python\nEmployee.objects.select_related('department').values('name', 'department__name')\n```\n\n#### Left Outer Join (using `prefetch_related` for Many-to-Many or reverse ForeignKey relationships)\n\n```python\nEmployee.objects.prefetch_related('projects')\n```\n\n### 7. **Subqueries**\n\nYou can use Django’s `Subquery` and `OuterRef` classes to perform subqueries within queries.\n\n#### Example: Subquery with Aggregate\n\nSQL:\n```sql\nSELECT name, salary\nFROM employee\nWHERE salary > (SELECT AVG(salary) FROM employee);\n```\n\nDjango ORM:\n```python\nfrom django.db.models import Subquery, OuterRef, Avg\n\navg_salary = Employee.objects.aggregate(Avg('salary'))['salary__avg']\nhigh_earners = Employee.objects.filter(salary__gt=avg_salary)\n```\n\n### 8. **Transactions in Django ORM**\n\nDjango’s `transaction.atomic` function allows you to manage transactions to ensure that operations are completed as a unit, similar to SQL’s `BEGIN TRANSACTION`, `COMMIT`, and `ROLLBACK`.\n\n```python\nfrom django.db import transaction\n\ntry:\n    with transaction.atomic():\n        Employee.objects.create(name=\"John Doe\", salary=60000)\n        Employee.objects.create(name=\"Jane Doe\", salary=70000)\nexcept:\n    print(\"Transaction failed\")\n```\n\n### 9. **Raw SQL in Django**\n\nIn cases where complex queries are required, Django allows you to execute raw SQL directly.\n\n```python\nfrom django.db import connection\n\nwith connection.cursor() as cursor:\n    cursor.execute(\"SELECT * FROM employee WHERE salary > %s\", [50000])\n    rows = cursor.fetchall()\n```\n\n### Summary\n\n| SQL Concept                  | Django ORM Equivalent                   |\n|------------------------------|-----------------------------------------|\n| Table                        | Model                                   |\n| Row                          | Model instance                          |\n| Column                       | Model field                             |\n| SELECT                       | `.all()`, `.filter()`, `.get()`         |\n| INSERT                       | `.create()`                             |\n| UPDATE                       | `.update()`                             |\n| DELETE                       | `.delete()`                             |\n| JOIN                         | `.select_related()`, `.prefetch_related()` |\n| GROUP BY                     | `.values()`, `.annotate()`              |\n| Aggregate Functions (SUM, AVG, etc.) | `.aggregate()`, `.annotate()` |\n| Transactions                 | `transaction.atomic()`                  |\n| Raw SQL                      | `connection.cursor().execute()`         |\n\nThe Django ORM provides a high-level, Pythonic interface to interact with your database, which is both powerful and flexible. Understanding how SQL concepts translate into Django ORM methods allows you to leverage the full potential of Django’s database management capabilities.\n","srcMarkdownNoYaml":"\n\n\n\n<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->\n\n### 1. **What is SQL?**\n   - **Language for Databases**: SQL is used to communicate with relational database management systems (RDBMS) such as MySQL, PostgreSQL, SQLite, Oracle, and Microsoft SQL Server.\n   - **Declarative Language**: SQL focuses on *what* data to retrieve or modify rather than *how* to do it, which the database engine handles.\n\n### 2. **Key SQL Commands**\nSQL commands are divided into categories based on their purpose:\n\n#### Data Definition Language (DDL)\n   - **`CREATE`**: Creates new tables, databases, indexes, and other objects.\n   - **`ALTER`**: Modifies an existing database object, such as a table.\n   - **`DROP`**: Deletes objects from the database.\n   - **`TRUNCATE`**: Removes all records from a table (without deleting the table itself).\n\n#### Data Manipulation Language (DML)\n   - **`SELECT`**: Retrieves data from the database.\n   - **`INSERT`**: Adds new records to a table.\n   - **`UPDATE`**: Modifies existing records in a table.\n   - **`DELETE`**: Removes records from a table.\n\n#### Data Control Language (DCL)\n   - **`GRANT`**: Grants permissions to users.\n   - **`REVOKE`**: Revokes permissions from users.\n\n#### Transaction Control Language (TCL)\n   - **`COMMIT`**: Saves changes to the database.\n   - **`ROLLBACK`**: Undoes changes since the last commit.\n   - **`SAVEPOINT`**: Sets a savepoint within a transaction to which you can later roll back.\n\n### 3. **Creating and Modifying Tables (DDL)**\n\n#### Create a Table\n```sql\nCREATE TABLE employees (\n    id INT PRIMARY KEY,\n    name VARCHAR(50),\n    position VARCHAR(50),\n    salary DECIMAL(10, 2),\n    hire_date DATE\n);\n```\n\n#### Alter a Table\nAdd a new column:\n```sql\nALTER TABLE employees\nADD email VARCHAR(100);\n```\n\nRemove a column:\n```sql\nALTER TABLE employees\nDROP COLUMN email;\n```\n\n#### Drop a Table\n```sql\nDROP TABLE employees;\n```\n\n### 4. **Basic Data Operations (DML)**\n\n#### Inserting Data\n```sql\nINSERT INTO employees (id, name, position, salary, hire_date)\nVALUES (1, 'John Doe', 'Software Engineer', 75000, '2022-01-15');\n```\n\n#### Selecting Data\n```sql\nSELECT name, position, salary\nFROM employees\nWHERE salary > 50000\nORDER BY hire_date DESC;\n```\n\n#### Updating Data\n```sql\nUPDATE employees\nSET salary = salary * 1.1  -- Increase salary by 10%\nWHERE position = 'Software Engineer';\n```\n\n#### Deleting Data\n```sql\nDELETE FROM employees\nWHERE hire_date < '2020-01-01';\n```\n\n### 5. **Querying Data with `SELECT`**\n\n#### Filtering with `WHERE`\n```sql\nSELECT * FROM employees\nWHERE position = 'Manager' AND salary > 70000;\n```\n\n#### Sorting with `ORDER BY`\n```sql\nSELECT name, salary FROM employees\nORDER BY salary DESC, name ASC;\n```\n\n#### Limiting Results with `LIMIT` (MySQL) / `FETCH FIRST` (SQL Server)\n```sql\nSELECT * FROM employees\nORDER BY salary DESC\nLIMIT 5;\n```\n\n#### Aggregating Data with Functions\n   - **`COUNT`**: Counts rows.\n   - **`SUM`**: Sums values.\n   - **`AVG`**: Calculates average.\n   - **`MIN`** and **`MAX`**: Find minimum and maximum values.\n\nExample:\n```sql\nSELECT AVG(salary) AS avg_salary, MAX(salary) AS max_salary\nFROM employees;\n```\n\n#### Grouping Results with `GROUP BY` and `HAVING`\n```sql\nSELECT position, AVG(salary) AS avg_salary\nFROM employees\nGROUP BY position\nHAVING avg_salary > 50000;\n```\n\n### 6. **Joins**\nJoins are used to retrieve data from multiple tables based on related columns.\n\n- **INNER JOIN**: Returns rows where there is a match in both tables.\n- **LEFT JOIN**: Returns all rows from the left table and matching rows from the right table.\n- **RIGHT JOIN**: Returns all rows from the right table and matching rows from the left.\n- **FULL OUTER JOIN**: Returns all rows from both tables, with NULLs where no match exists.\n\nExample of INNER JOIN:\n```sql\nSELECT employees.name, departments.department_name\nFROM employees\nINNER JOIN departments ON employees.department_id = departments.id;\n```\n\n### 7. **Subqueries**\nA subquery is a query nested within another query.\n\n#### Example: Subquery in `SELECT`\n```sql\nSELECT name,\n       (SELECT AVG(salary) FROM employees) AS avg_salary\nFROM employees\nWHERE salary > (SELECT AVG(salary) FROM employees);\n```\n\n### 8. **Indexes**\nIndexes improve the speed of data retrieval but may slow down insertions, updates, and deletions.\n\n```sql\nCREATE INDEX idx_position ON employees (position);\n```\n\n### 9. **Constraints**\nConstraints enforce data rules on tables, such as:\n   - **PRIMARY KEY**: Uniquely identifies each record.\n   - **FOREIGN KEY**: Ensures referential integrity between tables.\n   - **UNIQUE**: Ensures all values in a column are unique.\n   - **CHECK**: Ensures values meet a specific condition.\n   - **NOT NULL**: Ensures a column cannot contain NULL values.\n\nExample:\n```sql\nCREATE TABLE orders (\n    order_id INT PRIMARY KEY,\n    customer_id INT,\n    amount DECIMAL(10, 2) CHECK (amount > 0),\n    FOREIGN KEY (customer_id) REFERENCES customers(id)\n);\n```\n\n### 10. **Transactions and Atomicity**\nTransactions allow multiple SQL commands to be executed as a single unit.\n\n#### Example of Transaction with COMMIT and ROLLBACK\n```sql\nBEGIN;\n\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;\n\nCOMMIT;  -- Save changes\n-- Or ROLLBACK; to undo changes\n```\n\n### 11. **Views**\nViews are virtual tables that provide a way to save complex queries for easy reuse.\n\n```sql\nCREATE VIEW high_earners AS\nSELECT name, salary\nFROM employees\nWHERE salary > 80000;\n```\n\n### 12. **Stored Procedures and Functions**\nStored procedures and functions allow you to store reusable SQL code on the server side.\n\n#### Stored Procedure Example\n```sql\nCREATE PROCEDURE increase_salary (IN emp_id INT, IN increment DECIMAL(10, 2))\nBEGIN\n    UPDATE employees SET salary = salary + increment WHERE id = emp_id;\nEND;\n```\n\n#### User-Defined Function Example\n```sql\nCREATE FUNCTION get_full_name(first_name VARCHAR(50), last_name VARCHAR(50))\nRETURNS VARCHAR(100)\nBEGIN\n    RETURN CONCAT(first_name, ' ', last_name);\nEND;\n```\n\n### 13. **Common SQL Functions**\n   - **String Functions**: `UPPER`, `LOWER`, `CONCAT`, `SUBSTRING`.\n   - **Numeric Functions**: `ROUND`, `FLOOR`, `CEILING`, `ABS`.\n   - **Date Functions**: `NOW`, `CURDATE`, `YEAR`, `MONTH`, `DATEDIFF`.\n   - **Conversion Functions**: `CAST`, `CONVERT`.\n\n### 14. **Normalization**\nNormalization organizes data to reduce redundancy and dependency. Key normal forms include:\n   - **1NF (First Normal Form)**: Ensures each column contains atomic values.\n   - **2NF (Second Normal Form)**: Builds on 1NF by removing partial dependencies.\n   - **3NF (Third Normal Form)**: Removes transitive dependencies.\n\n### 15. **Advanced Concepts**\n   - **Recursive Queries**: Using `WITH RECURSIVE` for hierarchical data.\n   - **Window Functions**: Perform calculations across a set of table rows related to the current row (e.g., `ROW_NUMBER()`, `RANK()`).\n   - **Partitioning**: Divide large tables into smaller, manageable pieces.\n   - **Stored JSON Data**: Many RDBMS support storing and querying JSON data in tables.\n\n#### Example of a Recursive Query\n```sql\nWITH RECURSIVE org_chart AS (\n    SELECT employee_id, manager_id, name\n    FROM employees\n    WHERE manager_id IS NULL\n    UNION ALL\n    SELECT e.employee_id, e.manager_id, e.name\n    FROM employees e\n    JOIN org_chart oc ON e.manager_id = oc.employee_id\n)\nSELECT * FROM org_chart;\n```\n\n### 16. **Best Practices**\n   - Use indexes thoughtfully, as too many can slow down data modifications.\n   - Always back up your database before making major changes.\n   - Avoid using `SELECT *`; instead, specify columns for efficiency.\n   - Normalize tables to reduce redundancy and improve data integrity.\n\n\n## Django ORM to SQL\n\n> In Django, the **ORM (Object-Relational Mapping)** translates SQL operations into Python code, allowing you to interact with a database using Django's high-level `QuerySet` API. Here’s how common SQL concepts map to Django ORM concepts:\n\n### 1. **Models as Tables**\n\nIn Django, each database **table** is represented by a **model class**. Each field in the model corresponds to a column in the database table, and each instance of the model represents a row.\n\n#### SQL Table Definition\n```sql\nCREATE TABLE employee (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100),\n    department VARCHAR(50),\n    salary DECIMAL\n);\n```\n\n#### Django Model\n```python\nfrom django.db import models\n\nclass Employee(models.Model):\n    name = models.CharField(max_length=100)\n    department = models.CharField(max_length=50)\n    salary = models.DecimalField(max_digits=10, decimal_places=2)\n```\n\n### 2. **SQL Data Types to Django Field Types**\n\n| SQL Type      | Django Field Type              |\n|---------------|--------------------------------|\n| VARCHAR       | `models.CharField`             |\n| INTEGER       | `models.IntegerField`          |\n| DECIMAL       | `models.DecimalField`          |\n| DATE          | `models.DateField`             |\n| TIMESTAMP     | `models.DateTimeField`         |\n| BOOLEAN       | `models.BooleanField`          |\n| SERIAL        | `models.AutoField` (Primary Key by default) |\n\n### 3. **Basic CRUD Operations**\n\n#### CREATE: Inserting Data\nIn SQL:\n```sql\nINSERT INTO employee (name, department, salary) VALUES ('John Doe', 'Sales', 50000);\n```\n\nIn Django ORM:\n```python\nEmployee.objects.create(name=\"John Doe\", department=\"Sales\", salary=50000)\n```\n\n#### READ: Querying Data\n\n- **SELECT All**: Retrieve all rows from a table.\n\n    SQL:\n    ```sql\n    SELECT * FROM employee;\n    ```\n\n    Django ORM:\n    ```python\n    Employee.objects.all()\n    ```\n\n- **SELECT with WHERE Condition**:\n\n    SQL:\n    ```sql\n    SELECT * FROM employee WHERE department = 'Sales';\n    ```\n\n    Django ORM:\n    ```python\n    Employee.objects.filter(department=\"Sales\")\n    ```\n\n- **SELECT with Filtering and Ordering**:\n\n    SQL:\n    ```sql\n    SELECT * FROM employee WHERE department = 'Sales' ORDER BY salary DESC;\n    ```\n\n    Django ORM:\n    ```python\n    Employee.objects.filter(department=\"Sales\").order_by(\"-salary\")\n    ```\n\n#### UPDATE: Modifying Data\n\nIn SQL:\n```sql\nUPDATE employee SET salary = 55000 WHERE name = 'John Doe';\n```\n\nIn Django ORM:\n```python\nEmployee.objects.filter(name=\"John Doe\").update(salary=55000)\n```\n\n#### DELETE: Removing Data\n\nIn SQL:\n```sql\nDELETE FROM employee WHERE name = 'John Doe';\n```\n\nIn Django ORM:\n```python\nEmployee.objects.filter(name=\"John Doe\").delete()\n```\n\n### 4. **Relationships**\n\nDjango provides fields like `ForeignKey`, `OneToOneField`, and `ManyToManyField` to define relationships between models. These fields translate to `JOIN` operations in SQL.\n\n#### One-to-Many Relationship\n\nSQL:\n```sql\nCREATE TABLE department (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(50)\n);\n\nCREATE TABLE employee (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100),\n    department_id INTEGER REFERENCES department(id)\n);\n```\n\nDjango Models:\n```python\nclass Department(models.Model):\n    name = models.CharField(max_length=50)\n\nclass Employee(models.Model):\n    name = models.CharField(max_length=100)\n    department = models.ForeignKey(Department, on_delete=models.CASCADE)\n```\n\n**Querying with a Foreign Key**:\n```python\n# Get all employees in a specific department\nsales_dept = Department.objects.get(name=\"Sales\")\nemployees = Employee.objects.filter(department=sales_dept)\n```\n\n#### Many-to-Many Relationship\n\nSQL:\n```sql\nCREATE TABLE project (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100)\n);\n\nCREATE TABLE employee_project (\n    employee_id INTEGER REFERENCES employee(id),\n    project_id INTEGER REFERENCES project(id),\n    PRIMARY KEY (employee_id, project_id)\n);\n```\n\nDjango Models:\n```python\nclass Project(models.Model):\n    name = models.CharField(max_length=100)\n\nclass Employee(models.Model):\n    name = models.CharField(max_length=100)\n    projects = models.ManyToManyField(Project)\n```\n\n**Querying Many-to-Many Relationships**:\n```python\n# Get all projects for a specific employee\nemployee = Employee.objects.get(name=\"John Doe\")\nprojects = employee.projects.all()\n```\n\n### 5. **Aggregation and Grouping**\n\nThe Django ORM provides methods like `annotate()` and `aggregate()` for aggregation and grouping operations, similar to SQL’s `GROUP BY` and aggregate functions like `COUNT()`, `SUM()`, `AVG()`.\n\n#### Example: COUNT and GROUP BY\n\nSQL:\n```sql\nSELECT department, COUNT(*) FROM employee GROUP BY department;\n```\n\nDjango ORM:\n```python\nfrom django.db.models import Count\n\nEmployee.objects.values('department').annotate(count=Count('id'))\n```\n\n#### Example: SUM, AVG, MIN, MAX\n\nSQL:\n```sql\nSELECT AVG(salary) FROM employee WHERE department = 'Sales';\n```\n\nDjango ORM:\n```python\nfrom django.db.models import Avg\n\nEmployee.objects.filter(department=\"Sales\").aggregate(Avg('salary'))\n```\n\n### 6. **Joins with Django ORM**\n\nThe Django ORM automatically performs joins when you query across related models.\n\n#### Inner Join (default with ForeignKey)\n\nSQL:\n```sql\nSELECT employee.name, department.name\nFROM employee\nJOIN department ON employee.department_id = department.id;\n```\n\nDjango ORM:\n```python\nEmployee.objects.select_related('department').values('name', 'department__name')\n```\n\n#### Left Outer Join (using `prefetch_related` for Many-to-Many or reverse ForeignKey relationships)\n\n```python\nEmployee.objects.prefetch_related('projects')\n```\n\n### 7. **Subqueries**\n\nYou can use Django’s `Subquery` and `OuterRef` classes to perform subqueries within queries.\n\n#### Example: Subquery with Aggregate\n\nSQL:\n```sql\nSELECT name, salary\nFROM employee\nWHERE salary > (SELECT AVG(salary) FROM employee);\n```\n\nDjango ORM:\n```python\nfrom django.db.models import Subquery, OuterRef, Avg\n\navg_salary = Employee.objects.aggregate(Avg('salary'))['salary__avg']\nhigh_earners = Employee.objects.filter(salary__gt=avg_salary)\n```\n\n### 8. **Transactions in Django ORM**\n\nDjango’s `transaction.atomic` function allows you to manage transactions to ensure that operations are completed as a unit, similar to SQL’s `BEGIN TRANSACTION`, `COMMIT`, and `ROLLBACK`.\n\n```python\nfrom django.db import transaction\n\ntry:\n    with transaction.atomic():\n        Employee.objects.create(name=\"John Doe\", salary=60000)\n        Employee.objects.create(name=\"Jane Doe\", salary=70000)\nexcept:\n    print(\"Transaction failed\")\n```\n\n### 9. **Raw SQL in Django**\n\nIn cases where complex queries are required, Django allows you to execute raw SQL directly.\n\n```python\nfrom django.db import connection\n\nwith connection.cursor() as cursor:\n    cursor.execute(\"SELECT * FROM employee WHERE salary > %s\", [50000])\n    rows = cursor.fetchall()\n```\n\n### Summary\n\n| SQL Concept                  | Django ORM Equivalent                   |\n|------------------------------|-----------------------------------------|\n| Table                        | Model                                   |\n| Row                          | Model instance                          |\n| Column                       | Model field                             |\n| SELECT                       | `.all()`, `.filter()`, `.get()`         |\n| INSERT                       | `.create()`                             |\n| UPDATE                       | `.update()`                             |\n| DELETE                       | `.delete()`                             |\n| JOIN                         | `.select_related()`, `.prefetch_related()` |\n| GROUP BY                     | `.values()`, `.annotate()`              |\n| Aggregate Functions (SUM, AVG, etc.) | `.aggregate()`, `.annotate()` |\n| Transactions                 | `transaction.atomic()`                  |\n| Raw SQL                      | `connection.cursor().execute()`         |\n\nThe Django ORM provides a high-level, Pythonic interface to interact with your database, which is both powerful and flexible. Understanding how SQL concepts translate into Django ORM methods allows you to leverage the full potential of Django’s database management capabilities.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"sql.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.27","comments":{"utterances":{"repo":"quarto-dev/quarto-web"}},"author":"Benedict Thekkel","theme":{"light":"flatly","dark":"darkly"},"description":"SQL (Structured Query Language) is the standard language for managing and manipulating relational databases. It allows you to query, insert, update, delete, and manage data, making it a cornerstone of database management. Here’s a comprehensive guide to understanding SQL, with examples and key concepts.","skip_exec":true,"skip_showdoc":true,"title":"SQL"},"extensions":{"book":{"multiFile":true}}},"gfm":{"identifier":{"display-name":"Github (GFM)","target-format":"gfm","base-format":"gfm"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":false,"output-ext":"md","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"variant":"+autolink_bare_uris+emoji+footnotes+gfm_auto_identifiers+pipe_tables+strikeout+task_lists+tex_math_dollars"},"pandoc":{"standalone":true,"default-image-extension":"png","to":"commonmark","output-file":"sql.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"comments":{"utterances":{"repo":"quarto-dev/quarto-web"}},"description":"SQL (Structured Query Language) is the standard language for managing and manipulating relational databases. It allows you to query, insert, update, delete, and manage data, making it a cornerstone of database management. Here’s a comprehensive guide to understanding SQL, with examples and key concepts.","skip_exec":true,"skip_showdoc":true,"title":"SQL"}}},"projectFormats":["html","gfm"]}